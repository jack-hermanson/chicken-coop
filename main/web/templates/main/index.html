{% extends "base.html" %}

{% from "macros/card.html" import simple_card, card_body, card_header, card_footer %}
{% from "macros/pagination.html" import pagination %}
{% from "macros/form.html" import form_group %}
{% from "main/partials/shift-instance-partial.html" import shift_instance_partial %}

{% set title = "Shifts" %}
{% set active_route = "main" %}

{% set hide_title_row = True %}

{% block body %}
    <div class="row">
        <div class="col-12 col-lg-6 mb-3 mb-lg-0">
            <div class="row mb-3">
                <div class="col-12">
                    <h2 class="border-bottom mb-0">Upcoming Shifts</h2>
                    <p class="lead mb-0">Every day has two shiftsâ€”one for the morning and one for the
                        afternoon/evening.</p>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    {% for shift_instance_model in next_shift_instances %}

                        {% if loop.index0 == 2 %}
                            <p class="d-inline-flex gap-1">
                                <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#next_shifts_collapse">
                                    Toggle future shifts
                                </button>
                            </p>
                        {% endif %}

                        {% if loop.index0 == 2 %}
                            <div class="collapse" id="next_shifts_collapse">
                        {% endif %}

                    {{ shift_instance_partial(shift_instance_model) }}

                    {% if loop.index0 == loop.length - 1 %}
                        </div>
                    {% endif %}

                    {% endfor %}
                </div>
            </div>

        </div>

        <div class="col-12 col-lg-6">
            <div class="row mt-lg-0">
                <div class="col-12">
                    <h2 class="border-bottom mb-0">Previous Shifts</h2>
                    <p class="lead">These are shifts that have already passed. They can be edited up to 1 day back.</p>
                </div>
            </div>
            <div class="row" id="previous-shift-instances">
                <div class="col-12">
                    {% for shift_instance_model in previous_shift_instances.items %}
                        {{ shift_instance_partial(shift_instance_model) }}
                    {% endfor %}
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    {{ pagination(previous_shift_instances, "main.index", suffix="#previous-shift-instances") }}
                </div>
            </div>
        </div>
    </div>


    {#  Previous Shift Instances  #}
    {#    <div class="row" id="previous-shift-instances">#}
    {#        <div class="col-12">#}
    {#            <ul class="list-group">#}
    {#                {% for previous_shift_instance_model in previous_shift_instances.items %}#}
    {#                    <li class="list-group-item d-block">#}
    {#                        <h6>{{ previous_shift_instance.due_date.strftime("%A, %b %e") }}: {{ previous_shift_instance.shift.time_of_day|time_of_day_str }}</h6>#}
    {#                        <p class="mb-0">#}
    {#                            {% if previous_shift_instance.completed_timestamp %}#}
    {#                                Completed by {{ previous_shift_instance.completed_by }} at#}
    {#                                {{ previous_shift_instance.completed_timestamp }}.#}
    {#                            {% else %}#}
    {#                                Not completed.#}
    {#                            {% endif %}#}
    {#                        </p>#}
    {#                    </li>#}
    {#                {% endfor %}#}
    {#            </ul>#}
    {#        </div>#}
    {#    </div>#}
    {#    <div class="row">#}
    {#        <div class="col-12 d-flex justify-content-center">#}
    {#            <div>#}
    {#                {{ pagination(#}
    {#                            endpoint="main.index",#}
    {#                            pagination_model=previous_shift_instances,#}
    {#                            suffix="#previous-shift-instances") }}#}
    {#            </div>#}
    {#        </div>#}
    {#    </div>#}
{% endblock body %}

{% block scripts %}
    <script defer src="{{ url_for('static', filename='scripts/shift-instance-date.js') }}"></script>
{% endblock %}